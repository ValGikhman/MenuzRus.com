@model MenuzRus.Models.LoginModel
@using Services
<link href="@Url.Content("~/Content/Login.css")" rel="stylesheet" />
<div class="container">
    @using (Html.BeginForm("Index", "Login", FormMethod.Post, new { @id = "loginForm", @name = "loginForm", @class = "form-signin", role = "form" })) {
        <div id="panel" class="panel panel-primary shadow">
            <div class="navbar-inverse header">Please sign in</div>
            <div class="panel-body">
                <div class="row">
                    @Html.TextBoxFor(model => model.Email, new { @class = "form-control input-lg shadow", placeholder = "Email address", required = "", type = "email", autofocus = "" })
                    @Html.TextBoxFor(model => model.Password, new { @class = "form-control input-lg shadow", placeholder = "Password", required = "", type = "password" })
                </div>

                <div id="lastRow" class="row col-sm-8 col-md-8 col-lg-8 centered" style="display: none;">
                    <button id="register" class="btn btn-lg btn-default shadow" type="button">Register</button>
                    <button class="shadow btn btn-success btn-lg" type="submit">Sign in</button>
                </div>

                <div class="alert alert-danger fade in" role="alert" style="display: none;">
                    <button id="btnCloseXError" type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4>Log in failed</h4>
                    <p>Please check you credentials and try again. Close this window to continue.</p>
                    <p>
                        <button id="btnCloseError" type="button" class="btn btn-danger">Close</button>
                        <button type="submit" class="btn btn-default">Try again</button>
                    </p>
                </div>
            </div>
        </div>
    }
</div>
<!-- /container -->

<script type="text/javascript">
    $(function () {
        @if (!Model.Success) {
            @: $(".alert").show(); $("#lastRow").hide();
        }
        else {
            @: $("#lastRow").show(); $(".alert").hide();
        }

        $("#register").click(function () {
            window.location = $.validator.format("{0}Registration/", root);
        });

        $("#btnCloseXError, #btnCloseError").click(function () {
            $(".alert").alert("close");
            $("#lastRow").show();
        })
    });
</script>